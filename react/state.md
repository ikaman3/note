# state

## state의 특징

> 컴포넌트 간에 데이터를 공유하고 싶다면, 해당 컴포넌트들을 모두 포함하는 상위 컴포넌트에 state를 선언하고 두 자식 컴포넌트에 전달한다.  
> props를 사용한 컴포넌트 간의 state 공유를 'state 올리기'라고 한다.  
> state를 위로 이동하여 컴포넌트 간에 state를 공유하는 것이다.  

### 독립성과 비공개

> state는 화면에서 컴포넌트 인스턴스에 지역적이다. 
>  
> - 동일한 컴포넌트를 두 번 렌더링하면 각 복사본은 완전히 격리된 state를 가짐  
> - 대신, 화면의 특정 위치에 지역적이다. 같은 컴포넌트를 두 번 렌더링하면 그들의 state는 별도로 저장된다.  

> props와 달리, state는 선언한 컴포넌트에 완전히 비공개이다.  
> 부모 컴포넌트는 이를 변경할 수 없다.  


## state 변수가 필요한 순간

> 지역 변수는 렌더링 간에 유지되지 않는다.  
> - 같은 컴포넌트를 두 번째로 렌더링할 때 지역 변수에 대한 변경 사항은 고려하지 않고 처음부터 렌더링한다.  
>  
> 지역 변수를 변경해도 렌더링을 일으키지 않는다.  
> - 리액트가 새로운 데이터로 다시 렌더링해야 하는 것을 인식하지 못함  

즉, 컴포넌트를 새로운 데이터로 업데이트하기 위해선 두 가지가 필요하다.  

1. 렌더링 사이에 데이터를 **유지**  
2. 리액트가 새로운 데이터로 컴포넌트를 렌더링하도록 **유발**  

`useState` 훅은 이 두 가지를 제공한다.  

1. 렌더링 간에 데이터를 유지하기 위한 **state 변수**  
2. 변수를 업데이트하고 리액트가 컴포넌트를 다시 렌더링하도록 유발하는 **state setter 함수**  

## state 변수 추가

파일 상단의 React에서 `useState`를 가져온다.  

```javascript
import { useState } from 'react';

const [index, setIndex] = useState(0);

function handleClick() {
    setIndex(index + 1);
}
```

- 이때 `index`는 state 변수, `setIndex`는 setter 함수다.  
- 여기서 사용하는 `[]` 문법은 자바스크립트의 배열 구조 분해다.  
- `useState`가 반환하는 배열에는 항상 두 개의 항목이 있다.  

서로 연관이 없는 경우 여러 개의 state 변수를 가지는 것이 좋다.  
두 state 변수를 자주 함께 변경한다면(필드가 많은 form 등) 하나의 객체 state 변수를 사용하는 것이 편리하다.  

## hooks

> ```use``` 로 시작하는 함수를 *Hooks*라고 하며, ```useState``` 는 리액트에서 제공하는 내장 Hook이다.  
>  
> Hooks는 다른 함수보다 더 제한적이다.  
> 컴포넌트(또는 다른 Hooks)의 최상단 또는 커스텀 훅에서만 Hooks를 호출할 수 있다.  
> - 파일 상단에서 모듈을 "import"하는 것과 유사하게 컴포넌트 상단에서 리액트 기능을 "사용"한다.  
>  
> 훅은 리액트가 오직 렌더링 중일 때만 사용할 수 있다.  

### `useState`

state 변수와 state setter 함수의 이름은 원하는 대로 지을 수 있지만, 규칙을 사용하면 더 쉽게 이해할 수 있다.  
`const [something, setSomething]`  

> `useState`의 유일한 인수(arguments)는 state 변수의 **초깃값**이다.  

## 리액트가 state를 알아내는 방법

> 훅은 동일한 컴포넌트의 모든 렌더링에서 안정적인 호출 순서에 의존한다.  
> "최상단에서만 훅을 호출"한다는 규칙을 따르면, 훅은 항상 같은 순서로 호출되므로 잘 작동한다.  
>  
> 내부적으로 리액트는 모든 컴포넌트에 대해 한 쌍의 state 배열을 가진다.  
또한 렌더링 전에 `0`으로 설정된 현재 인덱스 쌍을 유지한다.  
> `useState`를 호출할 때마다, 다름 state 쌍을 제공하고 인덱스를 증가시킨다.  